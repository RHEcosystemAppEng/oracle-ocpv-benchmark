---
# Conditional OCPV Benchmark Setup
# This playbook installs benchmark tools based on the benchmark_tool variable
# Valid values: "hammerdb", "swingbench", "all"
# Default: "hammerdb" (installs HammerDB only)
#
# Usage:
#   ansible-playbook -i inventory.yaml main_setup_conditional_benchmark.yml
#   ansible-playbook -i inventory.yaml main_setup_conditional_benchmark.yml -e benchmark_tool=hammerdb
#   ansible-playbook -i inventory.yaml main_setup_conditional_benchmark.yml -e benchmark_tool=swingbench

# Always install Oracle client and TNS configuration
- import_playbook: playbooks/oracle-client/install_oracle_client.yml
- import_playbook: playbooks/configure-tnsnames/configure_tnsnames.yml

# Conditional benchmark tool installation
- name: Install Benchmark Tools Based on Selection
  hosts: oracle_benchmark_client_vms
  become: yes
  tasks:
    - name: Display installation plan
      debug:
        msg: |
          ðŸš€ Installation Plan:
          - Benchmark tool selection: {{ benchmark_tool | default('hammerdb') }}
          {% if benchmark_tool | default('hammerdb') in ['hammerdb', 'all'] %}
          - âœ… HammerDB {{ hammerdb_version }} will be installed
          {% endif %}
          {% if benchmark_tool | default('hammerdb') in ['swingbench', 'all'] %}
          - âœ… SwingBench {{ swingbench_version }} will be installed
          {% endif %}
          - Base path: {{ benchmark_base_path }}
          - Scripts path: {{ scripts_base_path }}

# Conditional HammerDB installation
- name: Install and Setup HammerDB for Oracle Benchmark
  import_playbook: playbooks/setup-hammerdb/install_setup_hammer_db.yml
  when: benchmark_tool | default('hammerdb') in ['hammerdb', 'all']

# Conditional SwingBench installation
- name: Install and Setup SwingBench for Oracle Benchmark
  import_playbook: playbooks/setup-swingbench/install_setup_swingbench.yml
  when: benchmark_tool | default('hammerdb') in ['swingbench', 'all'] 